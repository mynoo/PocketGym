<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapMember">
	<!-- 회원 가입하기 -->
	<insert id="insertData" parameterType="AlMember">
		insert into members(id, password, name, nickname, email, gender, height, career, aim_weight, address1, address2, period, birth) 
		values(#{id}, #{password}, #{name}, #{nickname}, #{email}, #{gender}, #{height}, #{career}, #{aim_weight}, #{address1}, #{address2}, #{period}, #{birth})
	</insert>
	
	<select id="selectData" resultType="AlMember">
		select * from members where id = #{id} and password = #{password}
	</select>
	
	<select id="selectById" parameterType="String"
	resultType="AlMember">
	select m.email, m.id, m.password, m.height, m.name, m.nickname, m.address1, m.address2,
	m.gender, m.career, m.period, m.aim_weight, m.ro_id, m.point, r.ro_name
	from members m inner join routines r on m.ro_id = r.ro_id where m.id =
	#{id}
	</select>

	<!-- 회원 최신 몸무게 가져오기 -->
	<select id="selectMyWeight" parameterType="String" resultType="int">
		select weight from myweight where mem_id=#{id} and rownum=1 order by
		weight_id desc
	</select>

	<!-- 회원 정보 수정하기 -->
	<update id="updateMember" parameterType="AlMember">
		update members set email = #{email}, password = #{password}, height =
		#{height}, nickname = #{nickname}, address = #{address}, aim_weight =
		#{aim_weight} where id = #{id}
	</update>
	
	<select id="selectDataID" resultType="AlMember">
      select * from members where id = #{id}
   </select>
   
   <select id="selectDataNickname" resultType="AlMember">
      select * from members where nickname = #{nickname}
   </select>
   
	<select id="selectForOrder" resultType="AlMember">
		select address1, address2, point, nickname from members where id = #{id}
	</select>
   
   <update id="changePoint" parameterType="AlOrder">
		update members set point = point - #{total_price} where id = #{mem_id}
	</update>
   
</mapper>